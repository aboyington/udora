function heroMap(e,t,a,i,o,s){function m(e){function r(o,s){if("latitudeLongitude"==s)t=new RichMarker({position:new google.maps.LatLng(e[o].latitude,e[o].longitude),map:n,draggable:!1,content:a,flat:!0}),google.maps.event.addListener(t,"click",function(e,t){return function(){"sidebar"==i?y($(this.content.firstChild).attr("data-id")):"infobox"==i?g($(this.content.firstChild).attr("data-id"),this,t):"modal"==i&&openModal($(this.content.firstChild).attr("data-id"),"modal_item.php")}}(t,o)),d.push(t);else if("address"==s){c=o;var r=new google.maps.Geocoder,l={address:e[o].address};r.geocode(l,v(a))}}function g(e,t,a){$.ajax({url:"external/infobox.php",dataType:"html",data:{id:e},method:"POST",success:function(i){infoboxOptions={content:i,disableAutoPan:!1,pixelOffset:new google.maps.Size(-135,-50),zIndex:null,alignBottom:!0,boxClass:"infobox-wrapper",enableEventPropagation:!0,closeBoxMargin:"0px 0px -8px 0px",closeBoxURL:"img/close-btn.png",infoBoxClearance:new google.maps.Size(1,1)},void 0!=m&&m.close(),d[a].infobox=new InfoBox(infoboxOptions),d[a].infobox.open(n,t),m=d[a].infobox,setTimeout(function(){$(".item.infobox[data-id="+e+"]").parent().addClass("show")},10),google.maps.event.addListener(d[a].infobox,"closeclick",function(){$(lastClickedMarker).removeClass("active")})},error:function(){console.log("error")}})}function v(e){return function(a,o){o==google.maps.GeocoderStatus.OK?(t=new RichMarker({position:a[0].geometry.location,map:n,draggable:!1,content:e,flat:!0}),d.push(t),b(),google.maps.event.addListener(t,"click",function(e,t){return function(){"sidebar"==i?y($(this.content.firstChild).attr("data-id")):"infobox"==i?g($(this.content.firstChild).attr("data-id"),this,0):"modal"==i&&openModal($(this.content.firstChild).attr("data-id"),"modal_item.php")}}(t,l))):console.log("Geocode failed "+o)}}function y(e){$.ajax({url:"external/sidebar_detail.php",data:{id:e},method:"POST",success:function(e){$(".sidebar-wrapper").html(e),$(".results-wrapper").removeClass("loading"),initializeOwl(),ratingPassive(".sidebar-wrapper .sidebar-content"),initializeFitVids(),socialShare(),initializeReadMore(),$(".sidebar-wrapper .back").on("click",function(){$(".results-wrapper").removeClass("show-detail"),$(lastClickedMarker).removeClass("active")}),$(document).keyup(function(e){switch(e.which){case 27:$(".sidebar-wrapper .back").trigger("click")}}),$(".results-wrapper").addClass("show-detail")},error:function(e){console.log("error "+e)}})}function b(){f=[],p=[],h=[];for(var e=0;e<d.length;e++)n.getBounds().contains(d[e].getPosition())?(h.push(d[e]),p.push($(d[e].content.firstChild).attr("data-id")),d[e].setVisible(!0)):d[e].setVisible(!1);$.ajax({url:"external/sidebar_results.php",method:"POST",data:{markers:p},success:function(e){f.push(e),$(".results-wrapper .results-content").html(e),$(".results-wrapper .section-title h2 .results-number").html(p.length),$(".result-item").on("mouseenter",function(){$(".map .marker[data-id="+$(this).attr("data-id")+"]").addClass("hover-state")}).on("mouseleave",function(){$(".map .marker[data-id="+$(this).attr("data-id")+"]").removeClass("hover-state")}),trackpadScroll("recalculate"),$(".result-item").children("a").on("click",function(e){"sidebar"==o?(e.preventDefault(),y($(this).parent().attr("data-id"))):"modal"==o&&(e.preventDefault(),openModal($(this).parent().attr("data-id"),"modal_item.php")),$(lastClickedMarker).removeClass("active"),$(".map .marker[data-id="+$(this).parent().attr("data-id")+"]").addClass("active"),lastClickedMarker=$(".map .marker[data-id="+$(this).parent().attr("data-id")+"]")})},error:function(e){console.log(e)}})}for(d=[],l=0;l<e.length;l++){var t,s,a=document.createElement("div");s=void 0!=e[l].marker_image?e[l].marker_image:"img/items/default.png",1==e[l].featured?a.innerHTML='<div class="marker" data-id="'+e[l].id+'"><div class="title">'+e[l].title+'</div><div class="marker-wrapper"><div class="tag"><i class="ion-ios-star"></i></div><div class="pin"><div class="image" style="background-image: url('+s+');"></div></div></div></div>':a.innerHTML='<div class="marker" data-id="'+e[l].id+'"><div class="title">'+e[l].title+'</div><div class="marker-wrapper"><div class="pin"><div class="image" style="background-image: url('+s+');"></div></div></div>',e[l].latitude&&e[l].longitude&&e[l].address?r(l,"latitudeLongitude"):!e[l].address||e[l].latitude||e[l].longitude?e[l].latitude&&e[l].longitude&&!e[l].address?r(l,"latitudeLongitude"):console.log("No location coordinates"):r(l,"address")}var m;$(".marker").live("mouseenter",function(){var e=$(this).attr("data-id");$(".results-wrapper .results-content .result-item[data-id="+e+"] a").addClass("hover-state")}).live("mouseleave",function(){var e=$(this).attr("data-id");$(".results-wrapper .results-content .result-item[data-id="+e+"] a").removeClass("hover-state")}),$(".marker").live("click",function(){$(this).attr("data-id");$(lastClickedMarker).removeClass("active"),$(this).addClass("active"),lastClickedMarker=$(this)});var w=[{url:"img/cluster.png",height:36,width:36}];u=new MarkerClusterer(n,d,{styles:w,maxZoom:14}),google.maps.event.addListener(n,"idle",function(){b()}),b()}function g(e){var t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);n.panTo(t),$("#map").removeClass("fade-map")}if(null!=document.getElementById(a)){var r,n=new google.maps.Map(document.getElementById(a),{zoom:14,scrollwheel:!1,center:new google.maps.LatLng(e,t),mapTypeId:"roadmap",styles:[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#c6c6c6"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#dde6e8"},{visibility:"on"}]}]});google.maps.event.addListenerOnce(n,"idle",function(){$.ajax({url:"external/data.php",dataType:"json",method:"POST",cache:!1,success:function(e){r=e,m(e)},error:function(e){console.log(e)}})}),1==s&&$(".hero-section .map").addClass("show-marker-labels");var l,c,u,d=[],f=[],p=[],h=[];$("[data-ajax-response='map']").on("click",function(e){e.preventDefault(),u.clearMarkers();for(var t=0;t<d.length;t++)d[t].setMap(null);$.ajax({url:"external/data_2.php",dataType:"json",method:"post",success:function(e){m(e)},error:function(e){console.log(e)}})}),$(".geo-location").on("click",function(){navigator.geolocation?($("#map").addClass("fade-map"),navigator.geolocation.getCurrentPosition(g)):error("Geo Location is not supported")}),autoComplete(n)}else console.log("No map element")}function simpleMap(e,t,a,i,o){function l(){return function(e,t){t==google.maps.GeocoderStatus.OK?(s=new google.maps.LatLng(e[0].geometry.location.lat(),e[0].geometry.location.lng()),c(s)):(console.log("Geocode failed"),console.log(t))}}function c(e){var t={zoom:14,center:e,disableDefaultUI:!0,scrollwheel:!0,styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{lightness:20},{color:"#ececec"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{visibility:"on"},{color:"#f0f0ef"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#f0f0ef"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{visibility:"on"},{color:"#d4d4d4"}]},{featureType:"landscape.natural",elementType:"all",stylers:[{visibility:"on"},{color:"#ececec"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"geometry",stylers:[{lightness:21},{visibility:"off"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#d4d4d4"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#303030"}]},{featureType:"poi",elementType:"labels.icon",stylers:[{saturation:"-100"}]},{featureType:"poi.attraction",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.business",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.government",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.medical",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{featureType:"poi.place_of_worship",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.school",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.school",elementType:"geometry.stroke",stylers:[{lightness:"-61"},{gamma:"0.00"},{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#dadada"},{lightness:17}]}]},o=document.getElementById(a),s=new google.maps.Map(o,t),n=new RichMarker({position:e,map:s,draggable:i,content:"<img src='img/marker.png'>",flat:!0});google.maps.event.addListener(n,"dragend",function(){this.position.lat(),this.position.lng();$("#latitude").val(this.position.lat()),$("#longitude").val(this.position.lng())}),autoComplete(s,n)}i||(i=!1);var s,n,r;o?(n=new google.maps.Geocoder,r={address:o},n.geocode(r,l())):(s=new google.maps.LatLng(e,t),c(s))}function autoComplete(e,t){function o(t){e.setCenter(new google.maps.LatLng(t.coords.latitude,t.coords.longitude)),$("#latitude").val(t.coords.latitude),$("#longitude").val(t.coords.longitude)}if($("#address-autocomplete").length){e||(e=new google.maps.Map(document.getElementById("address-autocomplete")));var a=document.getElementById("address-autocomplete"),i=new google.maps.places.Autocomplete(a);i.bindTo("bounds",e),google.maps.event.addListener(i,"place_changed",function(){var a=i.getPlace();if(a.geometry){a.geometry.viewport?e.fitBounds(a.geometry.viewport):(e.setCenter(a.geometry.location),e.setZoom(17)),t&&(t.setPosition(a.geometry.location),t.setVisible(!0),$("#latitude").val(t.getPosition().lat()),$("#longitude").val(t.getPosition().lng()));var o="";a.address_components&&(o=[a.address_components[0]&&a.address_components[0].short_name||"",a.address_components[1]&&a.address_components[1].short_name||"",a.address_components[2]&&a.address_components[2].short_name||""].join(" "))}}),$(".geo-location").on("click",function(){navigator.geolocation?($("#"+element).addClass("fade-map"),navigator.geolocation.getCurrentPosition(o)):console.log("Geo Location is not supported")})}}var lastClickedMarker;